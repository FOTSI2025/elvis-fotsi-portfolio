// Traductions FR / EN pour tout le site
const translations = {
  fr: {
    meta: {
      title: "Elvis Romarick Fotsi | Analyste de donnÃ©es & Statisticien",
      description: "Analyste de donnÃ©es, statisticien et professionnel en science des donnÃ©es basÃ© au QuÃ©bec, Canada. Expert en Python, R, Power BI, SAS, SQL.",
      keywords: "Analyste de donnÃ©es, Statisticien, Data Science, Python, R, Power BI, QuÃ©bec"
    },
    header: {
      name: "Elvis Romarick Fotsi",
      subtitle: "Analyste de donnÃ©es | Statisticien",
      location: "QuÃ©bec, Canada"
    },
    links: { email: "Email", linkedin: "LinkedIn" },
    about: {
      title: "Ã€ propos",
      content: "Analyste de donnÃ©es dynamique titulaire dâ€™une maÃ®trise en statistique, avec une solide expÃ©rience en Python, R, Power BI, SAS et Excel. SpÃ©cialisÃ© dans la transformation de donnÃ©es complexes en informations exploitables pour la prise de dÃ©cision."
    },
    skills: {
      title: "CompÃ©tences techniques",
      items: ["Python","R","SAS","SQL","Power BI","Excel","SPSS","ETL / ELT","Git / GitHub","Ã‰conomÃ©trie","Bases du Machine Learning"]
    },
    experience: {
      title: "ExpÃ©rience professionnelle",
      jobs: [
        {
          title: "ContrÃ´leur de projet â€“ Levio Conseils",
          company: "MinistÃ¨re de la CybersÃ©curitÃ© et du NumÃ©rique",
          period: "2025â€“PrÃ©sent",
          bullets: ["Analyse des donnÃ©es dâ€™assiduitÃ© des employÃ©s","Tableaux de bord Power BI","Appui Ã  la planification stratÃ©gique"]
        },
        {
          title: "Analyste de donnÃ©es â€“ MSSS QuÃ©bec",
          company: "MSSS QuÃ©bec",
          period: "2024â€“2025",
          bullets: ["Analyse de la base MedEcho","Financement axÃ© sur le patient","Traitement, imputation et validation des donnÃ©es"]
        }
      ]
    },
    projects: {
      title: "Projets",
      items: [
        { title: "ğŸ“Š ModÃ©lisation Ã©conomÃ©trique â€“ Banque Nationale du Canada", desc: "Estimation du volume de transactions internationales des investisseurs canadiens Ã  lâ€™aide de modÃ¨les Ã©conomÃ©triques.", tags: "R â€¢ Ã‰conomÃ©trie â€¢ PrÃ©sentation exÃ©cutive" },
        { title: "ğŸ“ˆ Analyse du risque systÃ©mique financier", desc: "Simulation Monte Carlo, test de causalitÃ© de Granger et analyse de dÃ©pendance entre marchÃ©s financiers.", tags: "Python â€¢ R â€¢ Finance" },
        { title: "ğŸ¥ Analyse des politiques de santÃ© publique", desc: "Ã‰valuation des politiques de financement hospitalier au QuÃ©bec Ã  partir de donnÃ©es administratives.", tags: "SAS â€¢ Excel â€¢ Analyse publique" }
      ]
    },
    education: {
      title: "Formation",
      items: [
        "MaÃ®trise en statistique (Data Science) â€” UniversitÃ© Laval, QuÃ©bec â€” 2025",
        "BaccalaurÃ©at en probabilitÃ© et statistique â€” ISSEA, Cameroun"
      ]
    },
    contact: {
      title: "Contact",
      email: "Email : dufotsi2020@gmail.com",
      phone: "TÃ©lÃ©phone : +1 581 459 6011"
    },
    footer: "Â© 2026 Elvis Romarick Fotsi"
  },

  en: {
    meta: {
      title: "Elvis Romarick Fotsi | Data Analyst & Statistician",
      description: "Data analyst, statistician and data science professional based in QuÃ©bec, Canada. Expert in Python, R, Power BI, SAS, SQL.",
      keywords: "Data Analyst, Statistician, Data Science, Python, R, Power BI, QuÃ©bec"
    },
    header: {
      name: "Elvis Romarick Fotsi",
      subtitle: "Data Analyst | Statistician",
      location: "QuÃ©bec, Canada"
    },
    links: { email: "Email", linkedin: "LinkedIn" },
    about: {
      title: "About",
      content: "Dynamic data analyst with a masterâ€™s degree in statistics, experienced in Python, R, Power BI, SAS, and Excel. Specialized in transforming complex data into actionable insights to support decision-making."
    },
    skills: {
      title: "Technical Skills",
      items: ["Python","R","SAS","SQL","Power BI","Excel","SPSS","ETL / ELT","Git / GitHub","Econometrics","Machine Learning basics"]
    },
    experience: {
      title: "Professional Experience",
      jobs: [
        {
          title: "Project Controller â€“ Levio Consulting",
          company: "Ministry of Cybersecurity and Digital",
          period: "2025â€“Present",
          bullets: ["Employee attendance data analysis","Power BI dashboards","Support for strategic planning"]
        },
        {
          title: "Data Analyst â€“ MSSS QuÃ©bec",
          company: "MSSS QuÃ©bec",
          period: "2024â€“2025",
          bullets: ["MedEcho database analysis","Patient-based funding","Data processing, imputation and validation"]
        }
      ]
    },
    projects: {
      title: "Projects",
      items: [
        { title: "ğŸ“Š Econometric modeling â€“ National Bank of Canada", desc: "Estimated the volume of international transactions of Canadian investors using econometric models.", tags: "R â€¢ Econometrics â€¢ Executive presentation" },
        { title: "ğŸ“ˆ Financial systemic risk analysis", desc: "Monte Carlo simulation, Granger causality testing and dependence analysis between financial markets.", tags: "Python â€¢ R â€¢ Finance" },
        { title: "ğŸ¥ Public health policy analysis", desc: "Evaluation of hospital funding policies in QuÃ©bec using administrative data.", tags: "SAS â€¢ Excel â€¢ Public analysis" }
      ]
    },
    education: {
      title: "Education",
      items: [
        "Masterâ€™s in Statistics (Data Science) â€” UniversitÃ© Laval, QuÃ©bec â€” 2025",
        "Bachelor in Probability and Statistics â€” ISSEA, Cameroon"
      ]
    },
    contact: {
      title: "Contact",
      email: "Email: dufotsi2020@gmail.com",
      phone: "Phone: +1 581 459 6011"
    },
    footer: "Â© 2026 Elvis Romarick Fotsi"
  }
};

// utilitaire pour accÃ©der Ã  une clÃ© imbriquÃ©e
function getByPath(obj, path) {
  return path.split('.').reduce((o, k) => (o ? o[k] : undefined), obj);
}

function renderListInto(el, listData) {
  // Accept multiple shapes: array, object with .items, object-of-strings
  let items = [];
  if (Array.isArray(listData)) items = listData;
  else if (listData && Array.isArray(listData.items)) items = listData.items;
  else if (listData && typeof listData === 'object') items = Object.values(listData);

  if (el.tagName.toLowerCase() === 'ul' || el.tagName.toLowerCase() === 'ol') {
    el.innerHTML = '';
    items.forEach(it => {
      const li = document.createElement('li');
      li.textContent = (typeof it === 'string') ? it : (it.title || JSON.stringify(it));
      el.appendChild(li);
    });
    return;
  }

  // containers for complex cards (jobs, projects, education)
  el.innerHTML = '';
  items.forEach(item => {
    const card = document.createElement('div');
    card.className = 'card';
    if (item.title) {
      const h3 = document.createElement('h3');
      h3.textContent = item.title;
      card.appendChild(h3);
    }
    if (item.company || item.period) {
      const span = document.createElement('span');
      span.textContent = [item.company || '', item.period || ''].filter(Boolean).join(' | ');
      card.appendChild(span);
    }
    if (item.desc) {
      const p = document.createElement('p');
      p.textContent = item.desc;
      card.appendChild(p);
    }
    if (Array.isArray(item.bullets)) {
      const ul = document.createElement('ul');
      item.bullets.forEach(b => {
        const li = document.createElement('li');
        li.textContent = b;
        ul.appendChild(li);
      });
      card.appendChild(ul);
    }
    if (item.tags) {
      const t = document.createElement('span');
      t.className = 'tags';
      t.textContent = item.tags;
      card.appendChild(t);
    }
    el.appendChild(card);
  });
}

function translatePage(lang) {
  const tr = translations[lang] || translations['fr'];
  document.documentElement.lang = lang;

  // meta & title
  if (tr.meta) {
    if (tr.meta.title) document.title = tr.meta.title;
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc && tr.meta.description) metaDesc.setAttribute('content', tr.meta.description);
    const metaKeys = document.querySelector('meta[name="keywords"]');
    if (metaKeys && tr.meta.keywords) metaKeys.setAttribute('content', tr.meta.keywords);
  }

  // simples remplacements textuels
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    const val = getByPath(tr, key);
    if (val !== undefined) el.textContent = val;
  });

  // listes / contenus dynamiques
  document.querySelectorAll('[data-i18n-list]').forEach(el => {
    const listKey = el.getAttribute('data-i18n-list');
    const listData = getByPath(tr, listKey) || getByPath(tr, `${listKey}.items`);
    if (!listData) return;
    renderListInto(el, listData);
  });

  localStorage.setItem('site-lang', lang);
}

// wiring des boutons
document.addEventListener('DOMContentLoaded', () => {
  const saved = localStorage.getItem('site-lang') || 'fr';
  translatePage(saved);

  const btnFr = document.getElementById('btn-fr');
  const btnEn = document.getElementById('btn-en');
  if (btnFr) btnFr.addEventListener('click', () => translatePage('fr'));
  if (btnEn) btnEn.addEventListener('click', () => translatePage('en'));
});
